<!doctype html>
<html lang="en">
 <head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <title>Academy - Gamebuino</title> 
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> 
  <link href="https://fonts.googleapis.com/css?family=Lato|Open+Sans:300,400,600,700,800|Roboto+Mono:300,400,700" rel="stylesheet"> 
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-LRlmVvLKVApDVGuspQFnRQJjkv0P7/YFrw84YYQtmYG4nK8c+M+NlmYDCv0rKWpG" crossorigin="anonymous"> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 
  <link href="../css/animate.css" rel="stylesheet" type="text/css"> 
  <link href="../css/generic.css" rel="stylesheet" type="text/css"> 
  <link href="../css/jquery-ui.min.css" rel="stylesheet" type="text/css"> 
  <link href="../css/jquery-ui-timepicker-addon.css" rel="stylesheet" type="text/css"> 
  <link href="../css/alertify.core.css" rel="stylesheet" type="text/css"> 
  <link href="../css/alertify.default.css" rel="stylesheet" type="text/css"> 
  <link href="../css/select2.min.css" rel="stylesheet" type="text/css"> 
  <link href="../css/app.css" rel="stylesheet" type="text/css"> 
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script> 
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> 
  <script src="../js/jquery.cookie.js" type="text/javascript"></script> 
  <script src="../js/alertify.min.js" type="text/javascript" async></script> 
  <script src="../js/modal.js" type="text/javascript" async></script> 
  <script src="../js/popupConfirm.js" type="text/javascript" async></script> 
  <script src="../js/select2.min.js" type="text/javascript" async></script> 
  <script src="../js/imagesloaded.pkgd.min.js" type="text/javascript" async></script> 
  <script src="../js/wow.min.js" type="text/javascript" async></script> 
  <script src="../js/app.js" type="text/javascript" async></script> 
  <script id="js_highlight" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" async></script> 
  <script>js_highlight.addEventListener('load',function(){$('div.code, pre').each(function(i,block){hljs.highlightBlock(block);});});</script> 
  <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700&amp;display=swap" rel="stylesheet"> 
 </head> 
 <body> 
  <div class="topbar-container w-100 m-0"> 
   <nav class="primary-navbar"> 
    <div id="root-logo"> <a href="/gamebuino/"> <img width="233" src="../assets/gamebuino-logo-white.svg" alt="Gamebuino" class="logo-white"> </a> 
    </div> 
    <ul class="nav nav-pills"> 
     <li class="text-uppercase"> <a href="/gamebuino/academy-en/"> Home of Academy (EN)</a></li> 
    </ul> 
   </nav> 
   <div class="container" id="main-content">
    <div class="container"> 
     <div class="d-flex align-items-center"> <a href="gamebuino/academy-en/index.html"> Academy </a> 
      <div class="ml-3 mr-3"> <i class="fal fa-angle-right"></i> 
      </div> <a href="gamebuino/academy-en/learn-to-code-a-snake-game-with-python.html"> Snake (Python) </a> 
      <div class="ml-3 mr-3"> <i class="fal fa-angle-right"></i> 
      </div> <span> Setting up </span> 
     </div> 
    </div> 
    <div class="row"> 
     <div class="col-md-8"> 
      <div class="d-flex justify-content-between"> 
       <div> 
        <h1> Setting up </h1> 
        <h5> Step 1 </h5> 
       </div> 
       <div> <span class="open-modal btn btn-complete btn-secondary"> <i class="fal fa-check"></i> Step completed? </span> 
       </div> 
      </div> 
      <div class="mt-5 white-container"> 
       <div class="lesson-introduction"> 
        <p>Script installation on the console.<br> Introducing functions.<br> Installing game engine.<br> Notions of colorimetric spaces.<br> Definition of the spatial reference frame of the META.<br> Introducing global variables.<br> Initialization of the graphical rendering engine.</p> 
       </div> 
       <div class="lesson-content mt-5"> 
        <h3>Script installation</h3> 
        <p>We will start by creating the game script and saving it directly to the Gamebuino as described <span>in the discovery workshop</span> in the section <strong>Run your first program</strong>. I'll leave it to you to check how to proceed if you have memory leaks...</p> 
        <p>Here is the bootstrap script <code>code.py</code>:</p> 
        <pre><code class="language-python">from gamebuino_meta import waitForUpdate, display, color, buttons

# ----------------------------------------------------------
# Main loop
# ----------------------------------------------------------

while True:
    waitForUpdate()
</code></pre> 
        <p>Once saved in the <code>CIRCUITPY</code> volume, your META screen turns all black.</p> 
        <blockquote> 
         <p><strong>Note</strong></p> 
         <p>The <code>#</code> symbol allows you to prefix comments in your code. Everything after this symbol, and on the same line, is not interpreted and therefore cannot be executed. Comments can help you clarify in your code to explain in which area you are in, or to describe what this or that portion of the code does, and why you defined things that way... It can make reading your code a lot easier when you have to share it with others, or even for yourself, when you come back in 6 months and you will have completely forgotten why you did it that way! So don't hesitate to comment on your code.&nbsp;&nbsp;<i class="far fa-smile-wink"></i></p> 
        </blockquote> 
        <h3>Setting up a scheduler</h3> 
        <p>To properly organize your code with Python, I encourage you to group instructions that participate in the same task into a <strong>function</strong>. A function is a block of instructions that you can then call at the appropriate time, much like a procedure that describes the task to be performed.</p> 
        <p>The general syntax of a function in Python is as follows:</p> 
        <pre><code class="language-python">def functionName(list of parameters):
    sequence of instructions to be executed
</code></pre> 
        <p>The declaration line of the function (the first line) must end with the <code>:</code> symbol, which allows you to enter the block of instructions that make up the <em>body</em> of the function. Note the indentation of the instructions in the body of the function. It is necessary for the Python interpreter to be able to determine that these instructions are part of the body of the function.</p> 
        <p>A function can accept a list of <em>parameters</em> (also called <em>arguments</em>). This list can also be empty, if the function does not expect any particular parameter.</p> 
        <h4>Main control loop</h4> 
        <p>We will create a first function that will allow us to schedule the main tasks to be performed at each <strong>execution cycle</strong> of the program.</p> 
        <p>The script has an <em>infinite loop</em> that runs indefinitely, as long as the program is running:</p> 
        <pre><code class="language-python">while True:
    waitForUpdate()
</code></pre> 
        <p>As with functions, the block of instructions to be executed is announced by the symbol <code>:</code> and is indented.</p> 
        <p>You will notice that the loop already has a call to the <code>waitForUpdate()</code> function, which does not take any parameters, and which waits until the graphic display executed at the previous iteration is finished before giving you back your hand so that you can execute your code and perform a screen refresh.</p> 
        <p>Iterations are performed at a frequency of 25 fps (<em>frames per second</em>). In other words, in one second, 25 iterations are performed. So, each iteration has 40 ms (1000 ms / 25) to execute. If the execution time of an iteration exceeds 40 ms, the overall application flow is automatically slowed down. This phenomenon is perceptible on the display... you will see that "it lags".</p> 
        <p>Well, let's start by defining our own function, which will be in charge of scheduling the different tasks to be performed for the game progress. Let's call it <code>tick</code>:</p> 
        <pre><code class="language-python">def tick():
    display.clear(color.BROWN)
</code></pre> 
        <p>Here, the <code>tick()</code> function simply erases the screen by applying a brown background color.</p> 
        <p>And to ask our scheduler to run each iteration of the main control loop, it will be enough to call the <code>tick()</code> function:</p> 
        <pre><code class="language-python">while True:
    waitForUpdate()
    tick()
</code></pre> 
        <h3>Colorimetric spaces</h3> 
        <p>There are some predefined colors that you can use. I refer you to the <span>documentation</span> concerning the official color palette for the META. This documentation targets the C++ language, which is the default language used to program on the Gamebuino, but the list of available colors is the same in Python.</p> 
        <p>You will find the definition of the <code>BROWN</code> color, which corresponds to <code>#CF8E44</code> hexadecimal color code in the RGB888 colorimetric space. An RGB888 color is defined from the 3 primary colors Red, Green and Blue, and is encoded on 3 bytes: 1 byte that indicates the intensity of the red color level, 1 byte for the green and 1 byte for the blue. Each byte has 8 bits (which can each be set to 0 or 1) and can therefore encode 2<sup>8</sup> different values, i.e. 256 values. If these values are characterized by integers, each integer is therefore between 0 and 255 (between <code>00</code> and <code>FF</code> in hexadecimal notation). If we combine the 3 bytes that encode the intensities of the 3 primary colors, we obtain 256<sup>3</sup> = 16 777 216 combinations, in other words: more than 16 million colors.</p> 
        <p>Actually, META is not able to display 16 million colors. The colorimetric reference frame is not RGB888, but RGB565. With RGB888 we had 8 bits per primary color (red, green or blue). With RGB565, only 5 bits are available for red, 6 for green and 5 for blue. In other words, the number of possible combinations corresponds to 2<sup>5</sup> x 2<sup>6</sup> x 2<sup>5</sup> = 2<sup>16</sup> = 65 536 colors. So much less than in RGB888! But it's not bad...</p> 
        <p>Then, how to convert a color from RGB888 to RGB565?<br> As it is a little beyond the scope of this workshop, I prefer to provide you with a small automatic converter to allow you to do this operation:</p> 
        <div style="margin:1.5em auto;" class="container"> 
         <form> 
          <div class="form-row align-items-center justify-content-sm-center"> 
           <div class="col col-sm-3"> 
            <div class="input-group"> 
             <div class="input-group-prepend"> 
              <div class="input-group-text">
                # 
              </div> 
             </div> 
             <input type="text" class="form-control" id="rgb888" placeholder="RGB888" value="CF8E44"> 
            </div> 
           </div> 
           <div class="col-sm-auto"> <span class="btn btn-primary" id="button_convert">Convert</span> 
           </div> 
           <div class="col col-sm-3"> 
            <input type="text" class="form-control" id="rgb565" placeholder="RGB565"> 
           </div> 
          </div> 
         </form> 
        </div> 
        <p>Try to convert the <code>BROWN</code> color hexa code for example (<code>#CF8E44</code>). You should get <code>0xCC68</code> as RGB565 color code. The <code>0x</code> prefix simply indicates that the integer is expressed in the hexadecimal base.</p> 
        <script src="https://gamebuino.m1cr0lab.com/academy/workshop/snake/rgb888-to-rgb565.js"></script> 
        <p>You can use any RGB565 color in your script. For example, you can replace the following instruction:</p> 
        <pre><code class="language-python">display.clear(color.BROWN)
</code></pre> 
        <p>with:</p> 
        <pre><code class="language-python">display.clear(0xCC68)
</code></pre> 
        <p>You will get the same result on the screen, since the <code>BROWN</code> color code is used here. But replace the hexadecimal code with another color and you will see that the result will be different.</p> 
        <p>For the background color of our game scene, we will use a slightly different brown color: <code>0x69c0</code>.</p> 
        <p>Well, we're also going to delimit the playground enclosure that the snake shouldn't cross. It will be represented by a simple orange rectangle, using <code>0xed40</code> color code:</p> 
        <pre><code class="language-python">def tick():
    display.clear(0x69c0)
    display.setColor(0xed40)
    display.drawRect(0, 0, 80, 64)
</code></pre> 
        <p>You see that after erasing the screen with one color, if you want to draw a shape with another color, you must specify it with the <code>display.setColor()</code> function. Here we simply draw a rectangle with the <code>display.drawRect(x, y, width, height)</code> function, which accepts 4 arguments: the (x,y) coordinates of the upper left corner, as well as the width and height of the rectangle.</p> 
        <h3>Spatial reference frame</h3> 
        <p>As we are going to make graphical plots on the screen, we will need to find ourselves easily in space to be able to position the different game elements. The META screen has 80x64 pixels, and its spatial reference is as follows:</p> 
        <div style="max-width:100%;width:504px;height:418px;margin:1.5em auto;"> 
         <img src="gamebuino/academy-en/assets/2-spatial-referential-1007x835.png" alt="Référentiel spatial" style="max-width:100%"> 
        </div> 
        <p>The spatial origin (0,0) is located at the top left, and each pixel is characterized by (x,y) coordinates where:</p> 
        <ul> 
         <li>x varies in [0,79] interval</li> 
         <li>y varies in [0,63] interval</li> 
        </ul> 
        <p>To position the different elements of the game, it will be necessary to perform calculations using the screen dimensions. It may therefore be useful to declare global constants at the beginning of the program to define these values once, and refer to them in our calculations. With Python, the notion of constant does not exist... so we will use global variables that will act as constants. And to properly identify them, they will be uppercased:</p> 
        <pre><code class="language-python">from gamebuino_meta import waitForUpdate, display, color, buttons

# ----------------------------------------------------------
# Global variables
# ----------------------------------------------------------

SCREEN_WIDTH  = 80
SCREEN_HEIGHT = 64
COLOR_BG      = 0x69c0
COLOR_WALL    = 0xed40
</code></pre> 
        <p>You see that I took the opportunity to also declare the colors that will be used as global variables. This way, if you want to change their values tomorrow, you can do it more easily, without having to look in your code where you used them.</p> 
        <p>We can modify our <code>tick()</code> function so that it is now based on these global variables:</p> 
        <pre><code class="language-python">def tick():
    display.clear(COLOR_BG)
    display.setColor(COLOR_WALL)
    display.drawRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT)
</code></pre> 
        <p>You see that the code is much more explicit when it is written in this way.</p> 
        <p>And finally, all the instructions that make up the <code>tick()</code> function are for the moment entirely dedicated to displaying the game scene. But we will add other tasks later on, so it would be appropriate here to gather all these display specific instructions in a dedicated function, which we could name <code>draw()</code> and call directly from the <code>tick()</code> function:</p> 
        <pre><code class="language-python"># ----------------------------------------------------------
# Game management
# ----------------------------------------------------------

def tick():
    draw()

# ----------------------------------------------------------
# Graphic display
# ----------------------------------------------------------

def draw():
    display.clear(COLOR_BG)
    display.setColor(COLOR_WALL)
    display.drawRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT)
</code></pre> 
        <p>You can see that the code is beginning to be structured by clearly showing the organization and semantics of the tasks to be performed. It is important to properly name your functions and variables so that you can easily understand what they do or what they are used for.</p> 
        <p>Well, in the end, here is the complete code that we get and that completes this implementation step (use the scroll bar to scroll through the entire code):</p> 
        <pre><code class="language-python">from gamebuino_meta import waitForUpdate, display, color, buttons

# ----------------------------------------------------------
# Global variables
# ----------------------------------------------------------

SCREEN_WIDTH  = 80
SCREEN_HEIGHT = 64
COLOR_BG      = 0x69c0
COLOR_WALL    = 0xed40

# ----------------------------------------------------------
# Game management
# ----------------------------------------------------------

def tick():
    draw()

# ----------------------------------------------------------
# Graphic display
# ----------------------------------------------------------

def draw():
    display.clear(COLOR_BG)
    display.setColor(COLOR_WALL)
    display.drawRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT)

# ----------------------------------------------------------
# Main loop
# ----------------------------------------------------------

while True:
    waitForUpdate()
    tick()
</code></pre> 
        <p>This is the display you should get by running this code on your META (just save the <code>code.py</code> script on the <code>CIRCUITPY</code> volume):</p> 
        <div style="max-width:100%;width:320px;height:256px;margin:1.5em auto;box-shadow:0 4px 8px #0006;"> 
         <img src="gamebuino/academy-en/assets/2-demo-640x512.png" alt="Démo" style="max-width:100%"> 
        </div> 
        <blockquote> 
         <p><strong>Note</strong></p> 
         <p>Throughout this workshop, don't forget to regularly save your <code>code.py</code> script. Typically, every time you define a new function. Also make copies of the script on your computer, because it can happen that the volume <code>CIRCUITPY</code> is savagely ejected... and you would lose all your code if you didn't make a copy of it first... So get into this habit right now, before the code becomes more consistent.&nbsp;&nbsp;<i class="far fa-smile-wink"></i></p> 
        </blockquote> 
       </div> 
      </div> 
     </div> 
     <div class="col-md-4 d-none d-md-block"> 
      <ul class="workshop-summary-mini"> 
       <li class=""> <a href="gamebuino/academy-en/overview.html" class="d-flex align-items-center  "> 
         <div class="circle">
           1 
         </div> 
         <div class="title ml-3">
           Overview 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/setting-up.html" class="d-flex align-items-center  active  "> 
         <div class="circle">
           2 
         </div> 
         <div class="title ml-3">
           Setting up 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/modeling.html" class="d-flex align-items-center  "> 
         <div class="circle">
           3 
         </div> 
         <div class="title ml-3">
           Modeling 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/controls-and-display.html" class="d-flex align-items-center  "> 
         <div class="circle">
           4 
         </div> 
         <div class="title ml-3">
           Controls and display 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/imposing-rules.html" class="d-flex align-items-center  "> 
         <div class="circle">
           5 
         </div> 
         <div class="title ml-3">
           Imposing rules 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/score-points.html" class="d-flex align-items-center  "> 
         <div class="circle">
           6 
         </div> 
         <div class="title ml-3">
           Score points 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/optimization.html" class="d-flex align-items-center  "> 
         <div class="circle">
           7 
         </div> 
         <div class="title ml-3">
           Optimization 
         </div> </a></li> 
       <li class=""> <a href="gamebuino/academy-en/finishes.html" class="d-flex align-items-center  "> 
         <div class="circle">
           8 
         </div> 
         <div class="title ml-3">
           Finishes 
         </div> </a></li> 
      </ul> 
     </div> 
    </div> 
    <div class="d-block d-md-none" style="margin-top:8rem"> 
     <h4 class="mb-4">Steps</h4> 
     <ul class="workshop-summary-mini"> 
      <li class=""> <a href="gamebuino/academy-en/overview.html" class="d-flex align-items-center  "> 
        <div class="circle">
          1 
        </div> 
        <div class="title ml-3">
          Overview 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/setting-up.html" class="d-flex align-items-center  active  "> 
        <div class="circle">
          2 
        </div> 
        <div class="title ml-3">
          Setting up 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/modeling.html" class="d-flex align-items-center  "> 
        <div class="circle">
          3 
        </div> 
        <div class="title ml-3">
          Modeling 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/controls-and-display.html" class="d-flex align-items-center  "> 
        <div class="circle">
          4 
        </div> 
        <div class="title ml-3">
          Controls and display 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/imposing-rules.html" class="d-flex align-items-center  "> 
        <div class="circle">
          5 
        </div> 
        <div class="title ml-3">
          Imposing rules 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/score-points.html" class="d-flex align-items-center  "> 
        <div class="circle">
          6 
        </div> 
        <div class="title ml-3">
          Score points 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/optimization.html" class="d-flex align-items-center  "> 
        <div class="circle">
          7 
        </div> 
        <div class="title ml-3">
          Optimization 
        </div> </a></li> 
      <li class=""> <a href="gamebuino/academy-en/finishes.html" class="d-flex align-items-center  "> 
        <div class="circle">
          8 
        </div> 
        <div class="title ml-3">
          Finishes 
        </div> </a></li> 
     </ul> 
    </div>
   </div> 
   <footer id="footer"> 
    <div class="container"> 
     <div class="reinsurance"> 
      <div class="row align-items-center"> 
       <div class="col-sm-3"> 
        <p class="text-left"></p> 
       </div> 
       <div class="col-sm-6"> 
        <p class="text-center">Academy saved on October 8, 2020</p> 
       </div> 
       <div class="col-sm-3"> 
        <p class="text-right"></p> 
       </div> 
      </div> 
     </div> 
     <div class="row"> 
      <div class="col-sm-4 margeur-50"> 
       <ul class=""> 
        <li class="margeur-20"><h5 style="color:white;">Exported by :</h5></li> 
        <li> <a href="https://chris-scientist.github.io">chris-scientist</a></li> 
       </ul> 
      </div> 
      <div class="col-sm-4 margeur-50"> 
       <ul class=""> 
        <li class="margeur-10"> <a href="/gamebuino/why-this-website/">Why this website ?</a></li> 
        <li class="margeur-10"> <a href="/gamebuino/contact/">Contact</a></li> 
       </ul> 
      </div> 
      <div class="col-sm-4 margeur-50"> 
       <h6 class="footer-h6">Exported from official website</h6> 
      </div> 
     </div> 
    </div> 
   </footer>  
  </div>
 </body>
</html>